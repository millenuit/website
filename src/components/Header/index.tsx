'use client';

import { useRef } from 'react';
import Link from 'next/link';
import { useMenu } from '@/context/MenuContext';
import clsx from 'clsx';
import styles from './index.module.css';
import { useGSAP } from '@gsap/react';
import { gsap } from '@/lib/gsap';

export default function Header() {
  const { isMenuOpen, toggleMenu } = useMenu();
  const buttonRef = useRef<HTMLButtonElement>(null);
  const topLineRef = useRef<HTMLDivElement>(null);
  const bottomLineRef = useRef<HTMLDivElement>(null);

  useGSAP(() => {
    if (!topLineRef.current) return;
    if (!bottomLineRef.current) return;

    if (isMenuOpen) {
      gsap.to(top, {
        y: 6,
        rotate: 45,
        duration: 0.4,
        ease: 'power2.out',
      });

      gsap.to(topLineRef.current, {
        y: 6,
        rotate: 45,
        duration: 0.4,
        ease: 'power2.out',
      });
      gsap.to(bottomLineRef.current, {
        y: -6,
        rotate: -45,
        duration: 0.4,
        ease: 'power2.out',
      });
    } else {
      gsap.to([topLineRef.current, bottomLineRef.current], {
        y: 0,
        rotate: 0,
        duration: 0.4,
        ease: 'power2.out',
      });
    }
  }, [isMenuOpen]);

  return (
    <header className={styles.header}>
      <div className={clsx(styles.container, 'container')}>
        <Link
          className={styles.logo}
          aria-label='Home'
          draggable='false'
          href='/'
        >
          <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 37.5'>
            <path
              d='M 25.376 34.821 C 24.695 34.821 24.355 34.269 24.355 33.164 C 24.355 31.093 25.49 27.678 27.76 22.917 C 27.477 16.142 26.128 10.998 23.715 7.483 C 21.7 4.563 19.316 3.104 16.562 3.104 C 14.717 3.104 13.128 3.741 11.794 5.017 C 10.46 6.292 9.793 7.837 9.793 9.651 C 9.793 10.53 9.963 11.423 10.304 12.33 C 11.496 15.192 13.199 17.247 15.413 18.495 C 15.583 18.58 15.626 18.707 15.54 18.878 C 15.399 19.018 15.271 19.047 15.158 18.962 C 12.234 17.375 10.191 15.164 9.026 12.33 C 8.743 11.593 8.53 10.878 8.388 10.187 C 8.246 9.49 8.175 8.801 8.175 8.12 C 8.175 5.74 8.984 3.784 10.601 2.253 C 12.135 0.751 14.079 0 16.435 0 C 20.352 0 23.517 2.041 25.93 6.123 C 28.059 9.722 29.293 14.186 29.634 19.515 C 30.798 17.588 31.999 15.793 33.236 14.132 C 34.468 12.477 35.765 10.955 37.128 9.566 C 40.307 6.306 43.457 4.167 46.579 3.147 C 46.807 3.061 47.071 2.99 47.372 2.934 C 47.667 2.876 47.999 2.819 48.368 2.764 C 48.311 2.707 48.751 2.636 49.688 2.551 C 49.83 2.522 49.98 2.508 50.139 2.508 C 50.293 2.508 50.426 2.508 50.539 2.508 C 53.009 2.508 54.244 3.444 54.244 5.315 C 54.244 5.995 54.031 6.632 53.605 7.228 C 53.122 7.879 52.512 8.206 51.774 8.206 C 51.15 8.206 50.667 8.007 50.327 7.611 C 49.958 7.242 49.773 6.803 49.773 6.292 C 49.773 4.932 50.44 4.252 51.774 4.252 C 52.428 4.252 52.895 4.507 53.179 5.017 C 53.066 4.223 52.37 3.755 51.093 3.614 C 49.305 3.444 47.389 5.017 45.345 8.334 C 43.584 11.224 42.038 14.852 40.704 19.218 C 39.427 23.413 38.788 26.884 38.788 29.634 C 38.788 32.016 39.327 33.205 40.406 33.205 C 41.172 33.205 42.109 32.496 43.216 31.08 C 44.295 29.72 45.572 27.509 47.048 24.447 C 47.161 24.164 47.304 23.993 47.474 23.937 L 47.516 23.937 C 47.629 23.937 47.686 24.036 47.686 24.234 C 47.686 24.461 47.629 24.688 47.516 24.915 C 45.955 28.089 44.99 29.945 44.621 30.485 C 43.202 32.724 41.796 33.929 40.406 34.099 C 40.321 34.099 40.236 34.104 40.151 34.116 C 40.065 34.133 39.98 34.141 39.895 34.141 C 38.873 34.141 37.922 33.772 37.042 33.036 C 35.793 31.93 35.169 30.243 35.169 27.976 C 35.169 25.284 36.091 21.925 37.936 17.899 C 39.441 14.697 41.23 11.635 43.301 8.716 C 45.032 6.278 46.735 4.52 48.411 3.444 C 45.288 4.322 41.896 6.632 38.235 10.374 C 35.141 13.549 32.288 17.29 29.676 21.598 C 29.733 27.409 28.682 31.661 26.525 34.353 C 26.27 34.665 25.887 34.821 25.376 34.821 M 3.619 37.5 C 2.427 37.5 1.504 37.16 0.851 36.48 C 0.284 35.912 0 35.189 0 34.312 C 0 33.517 0.256 32.823 0.766 32.228 C 1.249 31.661 1.888 31.377 2.682 31.377 C 3.222 31.377 3.689 31.576 4.088 31.973 C 4.4 32.313 4.555 32.738 4.555 33.248 C 4.555 33.929 4.301 34.481 3.789 34.907 C 3.336 35.332 2.824 35.544 2.257 35.544 C 1.575 35.544 1.05 35.275 0.681 34.736 C 0.738 35.189 0.994 35.572 1.448 35.884 C 1.93 36.195 2.47 36.352 3.066 36.352 C 3.349 36.352 3.633 36.309 3.917 36.224 C 6.955 35.374 10.148 32.468 13.497 27.509 C 15.172 25.013 16.741 22.231 18.206 19.158 C 19.664 16.08 21.005 12.713 22.226 9.056 C 22.396 8.546 22.551 8.291 22.693 8.291 C 22.836 8.291 22.921 8.39 22.949 8.588 C 22.977 8.787 22.977 8.971 22.949 9.141 C 22.126 12.315 21.326 15.113 20.547 17.534 C 19.764 19.96 19.004 22.009 18.266 23.682 C 14.831 31.42 10.687 35.927 5.833 37.203 C 5.067 37.4 4.329 37.5 3.619 37.5 Z M 51.987 17.007 C 51.022 17.007 50.539 16.539 50.539 15.603 C 50.539 14.668 50.993 14.201 51.902 14.201 C 52.866 14.201 53.35 14.668 53.35 15.603 C 53.35 16.539 52.895 17.007 51.987 17.007 M 46.197 33.461 C 45.373 33.461 44.962 33.049 44.962 32.228 C 44.962 31.717 45.132 31.023 45.473 30.145 C 46.211 28.33 46.906 26.658 47.559 25.128 C 48.212 23.597 48.822 22.208 49.39 20.961 C 49.475 20.818 49.517 20.663 49.517 20.493 C 49.517 20.096 49.333 19.671 48.964 19.218 L 51.306 19.175 C 52.1 19.175 52.498 19.373 52.498 19.77 C 52.498 19.884 52.47 20.003 52.413 20.127 C 52.356 20.258 52.285 20.437 52.2 20.663 L 48.283 29.72 C 47.885 30.655 47.686 31.448 47.686 32.1 C 47.686 32.781 47.899 33.234 48.326 33.461 L 46.197 33.461 Z M 53.775 33.461 C 52.952 33.461 52.54 33.049 52.54 32.228 C 52.54 31.717 52.711 31.023 53.051 30.145 L 61.312 9.056 C 61.369 8.971 61.397 8.886 61.397 8.801 C 61.397 8.716 61.397 8.645 61.397 8.588 C 61.397 8.163 61.226 7.723 60.886 7.271 L 63.185 7.271 C 63.979 7.271 64.377 7.454 64.377 7.823 C 64.377 7.993 64.292 8.291 64.122 8.716 L 55.861 29.72 C 55.493 30.626 55.308 31.434 55.308 32.143 C 55.308 32.795 55.506 33.234 55.904 33.461 L 53.775 33.461 Z M 61.226 33.461 C 60.403 33.461 59.991 33.049 59.991 32.228 C 59.991 31.717 60.162 31.023 60.503 30.145 L 68.762 9.056 C 68.819 8.971 68.847 8.886 68.847 8.801 C 68.847 8.716 68.847 8.645 68.847 8.588 C 68.847 8.163 68.677 7.723 68.337 7.271 L 70.636 7.271 C 71.431 7.271 71.828 7.454 71.828 7.823 C 71.828 7.993 71.743 8.291 71.572 8.716 L 63.313 29.72 C 62.944 30.626 62.759 31.434 62.759 32.143 C 62.759 32.795 62.957 33.234 63.355 33.461 L 61.226 33.461 Z M 71.403 33.631 C 70.295 33.631 69.344 33.276 68.549 32.568 C 68.124 32.171 67.82 31.711 67.638 31.191 C 67.451 30.663 67.358 30.06 67.358 29.38 C 67.358 26.772 68.437 24.178 70.593 21.598 C 72.41 19.416 74.298 18.325 76.256 18.325 C 76.909 18.325 77.463 18.495 77.916 18.835 C 78.4 19.232 78.64 19.741 78.64 20.366 C 78.64 21.925 77.604 23.483 75.532 25.042 C 74.879 25.524 74.014 25.949 72.935 26.318 C 71.743 26.714 70.877 26.913 70.338 26.913 C 69.94 27.877 69.741 28.897 69.741 29.974 C 69.741 31.816 70.423 32.738 71.785 32.738 C 73.573 32.738 75.249 31.576 76.809 29.252 L 76.98 28.997 L 77.703 29.294 L 77.576 29.549 C 76.866 30.966 75.972 32.001 74.893 32.653 C 73.814 33.304 72.651 33.631 71.403 33.631 M 70.593 26.19 C 71.076 26.19 71.743 26.034 72.594 25.722 C 73.077 25.524 73.539 25.312 73.982 25.085 C 74.42 24.858 74.808 24.603 75.149 24.32 C 76.71 23.016 77.491 21.641 77.491 20.195 C 77.491 19.572 77.264 19.261 76.809 19.261 C 76.015 19.261 74.808 20.238 73.191 22.194 C 72.367 23.185 71.502 24.518 70.593 26.19 Z M 78.683 37.5 C 76.327 37.5 75.149 36.48 75.149 34.439 C 75.149 33.759 75.362 33.121 75.788 32.525 C 76.242 31.901 76.809 31.59 77.491 31.59 C 78.087 31.59 78.597 31.803 79.024 32.228 C 79.393 32.653 79.577 33.107 79.577 33.588 C 79.577 34.949 78.966 35.629 77.746 35.629 C 77.008 35.629 76.497 35.345 76.214 34.779 C 76.384 35.8 77.25 36.309 78.811 36.309 C 79.123 36.309 79.422 36.267 79.705 36.182 C 82.913 35.332 86.034 32.213 89.072 26.828 C 89.582 25.921 90.179 24.75 90.86 23.316 C 91.541 21.888 92.322 20.195 93.202 18.239 C 94.791 14.725 96.154 12.032 97.289 10.162 C 99.049 7.326 101.136 4.875 103.548 2.807 L 102.782 2.679 C 102.328 2.593 101.853 2.536 101.36 2.508 C 100.86 2.479 100.327 2.466 99.759 2.466 C 98.737 2.466 97.709 2.522 96.676 2.636 C 95.637 2.749 94.592 2.919 93.542 3.147 C 92.493 3.372 91.549 3.642 90.715 3.954 C 89.875 4.266 89.129 4.606 88.476 4.975 C 85.268 6.845 83.664 8.716 83.664 10.587 C 83.664 12.118 84.701 12.883 86.772 12.883 C 87.965 12.883 89.328 12.557 90.86 11.905 C 92.393 11.224 93.713 10.331 94.82 9.226 C 94.933 9.17 95.018 9.141 95.075 9.141 C 95.303 9.141 95.416 9.239 95.416 9.439 C 95.416 9.495 95.402 9.538 95.374 9.566 C 94.521 10.672 93.245 11.635 91.541 12.458 C 89.838 13.279 88.093 13.69 86.305 13.69 C 84.714 13.69 83.395 13.378 82.345 12.755 C 81.295 12.131 80.769 11.295 80.769 10.247 C 80.769 9.254 81.295 8.149 82.345 6.931 C 83.849 5.172 86.247 3.827 89.54 2.891 C 90.931 2.494 92.387 2.196 93.909 1.999 C 95.425 1.799 97.019 1.7 98.694 1.7 C 99.603 1.7 100.468 1.743 101.292 1.828 C 102.115 1.913 102.909 1.999 103.676 2.083 C 103.733 2.083 103.826 2.091 103.957 2.109 C 104.082 2.12 104.244 2.139 104.443 2.168 C 104.896 1.941 105.266 1.884 105.549 1.999 C 105.862 1.941 106.145 1.899 106.401 1.871 C 106.656 1.842 106.897 1.828 107.125 1.828 C 108.488 1.828 109.168 2.182 109.168 2.891 C 109.168 3.231 108.984 3.5 108.614 3.699 C 108.217 3.897 107.778 3.996 107.295 3.996 C 106.641 3.996 105.833 3.713 104.868 3.147 C 103.505 3.939 102.824 5.995 102.824 9.311 C 102.824 11.806 103.131 14.541 103.744 17.517 C 104.351 20.493 105.266 23.738 106.486 27.253 C 106.798 28.104 106.997 28.529 107.082 28.529 C 107.11 28.529 107.125 28.047 107.125 27.084 C 107.21 21.612 108.43 16.27 110.786 11.055 C 113.709 4.677 117.486 1.488 122.112 1.488 C 124.241 1.488 125.305 2.196 125.305 3.614 C 125.305 4.266 125.12 4.832 124.751 5.315 C 124.298 5.91 123.744 6.207 123.091 6.207 C 122.552 6.207 122.112 6.023 121.771 5.655 C 121.431 5.315 121.261 4.932 121.261 4.507 C 121.261 3.231 121.871 2.593 123.091 2.593 C 123.659 2.593 124.085 2.819 124.369 3.274 C 124.255 2.451 123.616 2.041 122.453 2.041 C 122.084 2.041 121.709 2.091 121.329 2.194 C 120.943 2.29 120.564 2.451 120.196 2.679 C 117.386 4.407 114.561 8.419 111.723 14.711 C 108.941 20.805 107.621 25.751 107.763 29.549 C 108.217 30.088 108.557 30.485 108.785 30.74 C 109.013 30.995 109.14 31.136 109.168 31.165 C 109.736 31.93 110.02 32.696 110.02 33.461 C 110.02 33.914 109.878 34.324 109.594 34.693 C 109.311 35.063 108.941 35.247 108.488 35.247 C 107.692 35.247 107.139 34.652 106.826 33.461 C 106.798 33.262 106.764 33.049 106.724 32.823 C 106.679 32.596 106.656 32.356 106.656 32.1 C 106.656 31.476 106.741 30.768 106.912 29.974 C 105.577 27.82 104.343 24.915 103.208 21.258 C 101.845 16.922 101.164 13.166 101.164 9.991 C 101.164 8.007 101.434 6.391 101.973 5.144 C 100.213 6.306 98.496 9.594 96.821 15.009 C 95.771 18.438 94.805 21.306 93.926 23.614 C 93.046 25.927 92.251 27.678 91.541 28.869 C 88.703 33.744 84.757 36.592 79.705 37.415 C 79.534 37.443 79.364 37.466 79.194 37.483 C 79.024 37.494 78.853 37.5 78.683 37.5 Z M 118.195 33.418 C 116.379 33.418 115.47 32.568 115.47 30.868 C 115.47 30.272 115.64 29.472 115.981 28.469 C 116.322 27.46 116.804 26.261 117.429 24.873 L 119.77 19.728 C 120.026 19.133 120.579 18.835 121.431 18.835 L 123.985 18.835 C 122.991 19.572 122.084 20.762 121.261 22.406 C 120.948 23.03 120.573 23.804 120.136 24.728 C 119.693 25.647 119.189 26.701 118.62 27.891 C 118.082 28.997 117.811 29.988 117.811 30.868 C 117.811 31.774 118.124 32.228 118.748 32.228 C 119.43 32.228 120.239 31.689 121.175 30.612 C 122.736 28.797 124.837 25.17 127.477 19.728 C 127.789 19.133 128.328 18.835 129.095 18.835 L 131.394 18.835 C 130.457 19.601 129.478 21.003 128.456 23.045 C 127.036 25.907 126.185 28.089 125.901 29.592 C 125.873 29.762 125.853 29.917 125.841 30.06 C 125.824 30.2 125.816 30.343 125.816 30.485 C 125.816 31.59 126.199 32.143 126.966 32.143 C 127.789 32.143 128.754 31.335 129.861 29.72 L 130.5 30.017 C 128.967 32.284 127.449 33.418 125.944 33.418 C 124.354 33.418 123.559 32.412 123.559 30.4 C 123.559 29.634 123.701 28.826 123.985 27.976 C 121.884 31.604 119.955 33.418 118.195 33.418 Z M 138.078 17.007 C 137.114 17.007 136.63 16.539 136.63 15.603 C 136.63 14.668 137.085 14.201 137.993 14.201 C 138.958 14.201 139.441 14.668 139.441 15.603 C 139.441 16.539 138.987 17.007 138.078 17.007 M 132.288 33.461 C 131.465 33.461 131.053 33.049 131.053 32.228 C 131.053 31.717 131.224 31.023 131.564 30.145 C 132.303 28.33 132.997 26.658 133.65 25.128 C 134.304 23.597 134.913 22.208 135.482 20.961 C 135.566 20.818 135.609 20.663 135.609 20.493 C 135.609 20.096 135.424 19.671 135.055 19.218 L 137.397 19.175 C 138.192 19.175 138.589 19.373 138.589 19.77 C 138.589 19.884 138.561 20.003 138.505 20.127 C 138.447 20.258 138.377 20.437 138.291 20.663 L 134.374 29.72 C 133.976 30.655 133.778 31.448 133.778 32.1 C 133.778 32.781 133.991 33.234 134.417 33.461 L 132.288 33.461 Z M 142.379 33.461 C 140.533 33.461 139.611 32.454 139.611 30.442 C 139.611 30.045 139.645 29.634 139.713 29.209 C 139.787 28.784 139.909 28.359 140.08 27.934 C 141.584 23.965 142.861 20.734 143.911 18.239 L 141.144 18.239 L 141.655 17.305 L 144.295 17.305 L 145.317 14.328 C 145.685 13.279 145.998 12.655 146.253 12.458 C 146.452 12.315 146.906 12.245 147.615 12.245 L 149.447 12.287 C 148.878 12.769 148.453 13.35 148.169 14.031 L 146.764 17.305 L 150 17.305 L 149.489 18.239 L 146.381 18.239 C 146.183 18.693 145.989 19.146 145.802 19.601 C 145.62 20.054 145.416 20.521 145.189 21.003 C 144.592 22.307 144.082 23.54 143.656 24.702 C 143.145 26.034 142.739 27.182 142.439 28.146 C 142.143 29.109 141.967 29.875 141.91 30.442 C 141.797 31.831 142.166 32.525 143.017 32.525 C 143.812 32.525 144.777 31.676 145.913 29.974 L 146.424 30.569 C 145.061 32.496 143.713 33.461 142.379 33.461 Z'
              fill='currentColor'
            ></path>
          </svg>
        </Link>
        <button
          className={styles.menuButton}
          ref={buttonRef}
          onClick={toggleMenu}
          aria-label='Toggle menu'
        >
          <div className={styles.hamburger}>
            <div className={styles.line} ref={topLineRef} />
            <div className={styles.line} ref={bottomLineRef} />
          </div>
        </button>
      </div>
    </header>
  );
}
